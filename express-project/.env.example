# 服务器配置
PORT=3001
NODE_ENV=development

# JWT配置
JWT_SECRET=xiaoshiliu_secret_key_2025_production
JWT_EXPIRES_IN=7d
REFRESH_TOKEN_EXPIRES_IN=30d

# 数据库配置
DB_HOST=localhost
DB_USER=root
DB_PASSWORD=123456
DB_NAME=xiaoshiliu
DB_PORT=3306

# API配置
API_BASE_URL=http://localhost:3001

# 上传配置
UPLOAD_MAX_SIZE=50mb
# 图片上传策略 (local: 本地存储, imagehost: 第三方图床, r2: Cloudflare R2)
IMAGE_UPLOAD_STRATEGY=imagehost
# 视频上传策略 (local: 本地存储, r2: Cloudflare R2)
VIDEO_UPLOAD_STRATEGY=local

# 本地存储配置
LOCAL_UPLOAD_DIR=uploads
LOCAL_BASE_URL=http://localhost:3001
# 视频存储目录
VIDEO_UPLOAD_DIR=uploads/videos
# 视频封面存储目录
VIDEO_COVER_DIR=uploads/covers

# 视频转码配置
# FFmpeg可执行文件路径
FFMPEG_PATH=/app/bin/ffmpeg
FFPROBE_PATH=/app/bin/ffprobe
# 是否启用视频转码为DASH格式 (true/false)
VIDEO_TRANSCODING_ENABLED=true
# 转码最大线程数 (避免资源占用过多)
# 建议值: CPU核心数的50-75%，如4核CPU设置为2-3
VIDEO_TRANSCODING_MAX_THREADS=4
# DASH转码输出目录格式，支持变量: {date}, {userId}, {timestamp}
# 默认格式: YYYY-MM-DD/userId/timestamp
VIDEO_DASH_OUTPUT_FORMAT={date}/{userId}/{timestamp}
# DASH分片时长（秒）
DASH_SEGMENT_DURATION=4
# 最小码率 (kbps)
DASH_MIN_BITRATE=500
# 最大码率 (kbps) - 1080p
DASH_MAX_BITRATE=5000
# 原始视频最大码率 (kbps) - 对原始视频进行压缩时使用
# 这将提供一个"原始"画质选项，保持原始分辨率但进行压缩
ORIGINAL_VIDEO_MAX_BITRATE=8000
# 支持的分辨率列表（逗号分隔），系统会智能检测视频实际分辨率，只转换存在的分辨率
# 格式: 宽x高:码率kbps
# 注意: 系统会自动根据视频宽高比等比例缩放，保证画面不变形
# 例如: 720x1280 的竖屏视频不会被强制转换为 640x360 (会变形)
# 而是会等比例缩放为适合的尺寸，如 360p 会转为 204x360
DASH_RESOLUTIONS=1920x1080:5000,1280x720:2500,854x480:1000,640x360:750
# 是否删除原始视频文件（转码成功后）
DELETE_ORIGINAL_VIDEO=false

# 视频分片上传配置
# 分片临时存储目录
VIDEO_CHUNK_TEMP_DIR=uploads/chunks
# 分片大小（字节），默认3MB
VIDEO_CHUNK_SIZE=3145728
# 分片自动清理间隔（毫秒），默认30分钟
VIDEO_CHUNK_CLEANUP_INTERVAL=1800000
# 分片过期时间（毫秒），默认2小时
VIDEO_CHUNK_EXPIRE_TIME=7200000

# 第三方图床配置（当IMAGE_UPLOAD_STRATEGY=imagehost时使用）
IMAGEHOST_API_URL=https://api.xinyew.cn/api/jdtc
IMAGEHOST_TIMEOUT=60000

# Cloudflare R2 配置（当IMAGE_UPLOAD_STRATEGY=r2或VIDEO_UPLOAD_STRATEGY=r2时使用）
# 请从 Cloudflare 控制台获取您自己的配置信息
R2_ACCESS_KEY_ID=your_r2_access_key_id_here
R2_SECRET_ACCESS_KEY=your_r2_secret_access_key_here
R2_ENDPOINT=https://your_account_id.r2.cloudflarestorage.com
R2_BUCKET_NAME=your_bucket_name_here
R2_ACCOUNT_ID=your_account_id_here
R2_REGION=auto
# 可选：如果有自定义域名，可以设置 R2_PUBLIC_URL
# R2_PUBLIC_URL=https://your-custom-domain.com

# 注意：
# 1. R2_ACCOUNT_ID 需要从 Cloudflare 控制台获取
# 2. R2_BUCKET_NAME 需要先在 Cloudflare R2 中创建存储桶
# 3. 如果使用自定义域名，需要在 Cloudflare 中配置域名绑定
# 4. 请不要将真实的密钥提交到版本控制系统中

# CORS配置
CORS_ORIGIN=http://localhost:5173

# 邮件服务配置
# 是否启用邮件功能 (true/false)
# 默认不启用，设置为true时注册需要邮箱验证
EMAIL_ENABLED=false
# SMTP服务器地址
SMTP_HOST=smtp.qq.com
# SMTP服务器端口
SMTP_PORT=465
# 是否使用SSL/TLS (true/false)
SMTP_SECURE=true
# 邮箱账号
SMTP_USER=your_email@example.com
# 邮箱密码/授权码
SMTP_PASSWORD=your_email_password
# 发件人邮箱
EMAIL_FROM=your_email@example.com
# 发件人名称
EMAIL_FROM_NAME=汐社校园图文社区

# OAuth2 登录配置
# 是否启用OAuth2登录 (true/false)
# 启用后可以使用第三方用户中心登录
OAUTH2_ENABLED=false
# 是否仅允许OAuth2登录 (true/false)
# 设置为true时，将禁用传统的用户名密码登录和注册功能
OAUTH2_ONLY_LOGIN=false
# OAuth2服务器地址（登录服务地址）
# 例如：https://login.example.com
OAUTH2_LOGIN_URL=
# OAuth2 Client ID（从管理后台获取的API令牌）
OAUTH2_CLIENT_ID=

# 余额中心配置
# 是否启用余额中心功能 (true/false)
BALANCE_CENTER_ENABLED=false
# 外部用户中心API地址
BALANCE_API_URL=https://user.yuelk.com
# API密钥（从用户中心后台获取）
BALANCE_API_KEY=
# 兑入比例：1本站积分 = X 用户中心余额
BALANCE_EXCHANGE_RATE_IN=1.0
# 兑出比例：1用户中心余额 = X 本站积分
BALANCE_EXCHANGE_RATE_OUT=1.0